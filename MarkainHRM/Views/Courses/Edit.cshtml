@model OzarkLMS.Models.Course

<div class="p-8 max-w-[800px] mx-auto">
    <div class="bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden">
        <div class="p-6 border-b border-gray-100 bg-gray-50 flex justify-between items-center">
             <h1 class="text-xl font-bold text-[#004B87]">Edit Course</h1>

             <button onclick="openDeleteModal(@Model.Id, '@Model.Name')" type="button" class="text-red-500 hover:text-red-700 text-sm font-bold flex items-center">
                 <i data-lucide="trash-2" class="w-4 h-4 mr-1"></i> Delete
             </button>
        </div>
        
        <form asp-action="Edit" class="p-8 space-y-6">
            <input type="hidden" asp-for="Id" />
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label asp-for="Name" class="block text-sm font-bold text-slate-700 mb-2">Course Name</label>
                    <input asp-for="Name" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-[#004B87] focus:ring-[#004B87]" placeholder="e.g. Advanced Mathematics" />
                    <span asp-validation-for="Name" class="text-red-500 text-xs"></span>
                </div>
                <div>
                    <label asp-for="Code" class="block text-sm font-bold text-slate-700 mb-2">Course Code</label>
                    <input asp-for="Code" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-[#004B87] focus:ring-[#004B87]" placeholder="e.g. MTH-404" />
                    <span asp-validation-for="Code" class="text-red-500 text-xs"></span>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label asp-for="Term" class="block text-sm font-bold text-slate-700 mb-2">Term</label>
                    <input asp-for="Term" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-[#004B87] focus:ring-[#004B87]" />
                </div>
                @if (User.IsInRole("admin"))
                {
                    <div>
                        <label asp-for="InstructorId" class="block text-sm font-bold text-slate-700 mb-2">Assign Manager</label>
                        <select asp-for="InstructorId" class="w-full rounded-lg border-gray-300 shadow-sm focus:border-[#004B87] focus:ring-[#004B87]" 
                                asp-items="@(new SelectList(ViewBag.Instructors, "Id", "Username"))">
                            <option value="">-- Select Manager --</option>
                        </select>
                    </div>
                }
                else
                {
                    <input type="hidden" asp-for="InstructorId" />
                }
            </div>
            
            <div>
                 <label class="block text-sm font-bold text-slate-700 mb-2">Visual Theme</label>
                 <div class="flex space-x-4">
                     <label class="cursor-pointer">
                         <input type="radio" asp-for="Color" value="bg-blue-500" class="peer sr-only" />
                         <div class="w-8 h-8 rounded-full bg-blue-500 ring-2 ring-transparent peer-checked:ring-offset-2 peer-checked:ring-blue-500"></div>
                     </label>
                     <label class="cursor-pointer">
                         <input type="radio" asp-for="Color" value="bg-red-500" class="peer sr-only" />
                         <div class="w-8 h-8 rounded-full bg-red-500 ring-2 ring-transparent peer-checked:ring-offset-2 peer-checked:ring-red-500"></div>
                     </label>
                     <label class="cursor-pointer">
                         <input type="radio" asp-for="Color" value="bg-green-500" class="peer sr-only" />
                         <div class="w-8 h-8 rounded-full bg-green-500 ring-2 ring-transparent peer-checked:ring-offset-2 peer-checked:ring-green-500"></div>
                     </label>
                     <label class="cursor-pointer">
                         <input type="radio" asp-for="Color" value="bg-purple-500" class="peer sr-only" />
                         <div class="w-8 h-8 rounded-full bg-purple-500 ring-2 ring-transparent peer-checked:ring-offset-2 peer-checked:ring-purple-500"></div>
                     </label>
                 </div>
            </div>

            <div class="flex justify-end pt-6 border-t border-gray-100">
                <a asp-action="Index" class="mr-4 px-6 py-2 text-slate-500 font-bold hover:text-slate-700">Cancel</a>
                <button type="submit" class="bg-[#004B87] text-white px-6 py-2 rounded-lg font-bold hover:bg-[#003d6e] shadow-lg shadow-blue-900/20">
                    Save Changes
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="deleteModal" class="fixed inset-0 z-50 hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
    <div class="fixed inset-0 bg-slate-900/50 backdrop-blur-sm transition-opacity" onclick="closeDeleteModal()"></div>
    
    <div class="fixed inset-0 z-10 w-screen overflow-y-auto">
        <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
            <div class="relative transform overflow-hidden rounded-2xl bg-white dark:bg-slate-800 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-md border border-slate-100 dark:border-slate-700">
                <div class="p-6">
                    <div class="flex items-center justify-center w-12 h-12 mx-auto bg-red-100 dark:bg-red-900/30 rounded-full mb-4">
                        <i data-lucide="alert-triangle" class="w-6 h-6 text-red-600 dark:text-red-400"></i>
                    </div>
                    <div class="text-center">
                        <h3 class="text-lg font-bold text-slate-900 dark:text-white mb-2" id="modal-title">Delete Course</h3>
                        <p class="text-sm text-slate-500 dark:text-slate-400">
                            Are you sure you want to delete <span id="deleteCourseName" class="font-bold text-slate-800 dark:text-slate-200"></span>? 
                            This action cannot be undone.
                        </p>
                    </div>
                </div>
                <div class="bg-slate-50 dark:bg-slate-700/50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6">
                    <form asp-action="Delete" method="post" class="w-full sm:w-auto sm:ml-3">
                        <input type="hidden" id="deleteCourseId" name="id" value="" />
                        <button type="submit" class="inline-flex w-full justify-center rounded-xl bg-red-600 px-3 py-2 text-sm font-bold text-white shadow-sm hover:bg-red-500 sm:w-auto transition-colors">
                            Delete Course
                        </button>
                    </form>
                    <button type="button" onclick="closeDeleteModal()" class="mt-3 inline-flex w-full justify-center rounded-xl bg-white dark:bg-slate-800 px-3 py-2 text-sm font-bold text-slate-900 dark:text-slate-300 shadow-sm ring-1 ring-inset ring-slate-300 dark:ring-slate-600 hover:bg-slate-50 dark:hover:bg-slate-700 sm:mt-0 sm:w-auto transition-colors">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function openDeleteModal(id, name) {
        document.getElementById('deleteCourseId').value = id;
        document.getElementById('deleteCourseName').innerText = name;
        document.getElementById('deleteModal').classList.remove('hidden');
    }

    function closeDeleteModal() {
        document.getElementById('deleteModal').classList.add('hidden');
    }
</script>
