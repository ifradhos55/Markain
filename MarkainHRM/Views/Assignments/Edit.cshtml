@model OzarkLMS.Models.Assignment

@{
    ViewData["Title"] = "Edit Quiz";
}

<div class="p-8 max-w-[1000px] mx-auto">
    <div class="flex justify-between items-center mb-6">
        <div>
            <h1 class="text-2xl font-bold text-[#004B87]">Edit Quiz: @Model.Title</h1>
            <p class="text-slate-500">Add questions and options for this quiz.</p>
        </div>
        <a asp-controller="Courses" asp-action="Details" asp-route-id="@Model.CourseId" asp-route-tab="assignments" class="text-slate-500 hover:text-slate-700 font-medium">Done</a>
    </div>

    <!-- Questions List -->
    <div class="space-y-6 mb-8">
        @foreach (var question in Model.Questions)
        {
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 relative">
                 <form asp-action="DeleteQuestion" method="post" class="absolute top-4 right-4">
                     <input type="hidden" name="id" value="@question.Id" />
                     <input type="hidden" name="assignmentId" value="@Model.Id" />
                     <button type="submit" class="text-red-400 hover:text-red-600"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                 </form>

                 <div class="mb-4">
                     <span class="bg-blue-100 text-[#004B87] px-2 py-1 rounded text-xs font-bold uppercase mb-2 inline-block">Question</span>
                     <h3 class="text-lg font-bold text-slate-800">@question.Text</h3>
                     <p class="text-xs text-slate-400">@question.Points Points</p>
                 </div>

                 <!-- Options -->
                 <div class="pl-4 border-l-2 border-gray-100 space-y-2 mb-4">
                     @foreach(var option in question.Options)
                     {
                         <div class="flex items-center text-sm">
                             <div class="w-4 h-4 rounded-full border flex items-center justify-center mr-2 @(option.IsCorrect ? "bg-green-100 border-green-500 text-green-700" : "border-slate-300")">
                                 @if(option.IsCorrect) { <i data-lucide="check" class="w-3 h-3"></i> }
                             </div>
                             <span class="@(option.IsCorrect ? "font-bold text-green-700" : "text-slate-600")">@option.Text</span>
                         </div>
                     }
                 </div>

                 <!-- Add Option Form -->
                 <form asp-action="AddOption" method="post" class="flex gap-2 items-center mt-4 pt-4 border-t border-gray-50">
                     <input type="hidden" name="questionId" value="@question.Id" />
                     <input type="hidden" name="assignmentId" value="@Model.Id" />
                     <input type="text" name="text" placeholder="New Option" class="flex-1 rounded-lg border-gray-200 text-sm py-1.5 focus:border-[#004B87] focus:ring-[#004B87]" required />
                     <label class="flex items-center space-x-2 text-sm text-slate-600 bg-gray-50 px-3 py-1.5 rounded-lg border border-gray-200 cursor-pointer hover:bg-white transition-colors">
                         <input type="checkbox" name="isCorrect" value="true" class="rounded text-[#004B87] focus:ring-[#004B87]" />
                         <span>Correct?</span>
                     </label>
                     <button type="submit" class="bg-slate-100 text-slate-600 px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-slate-200 uppercase">Add Option</button>
                 </form>
            </div>
        }
    </div>

    <!-- Add Question Form -->
    <div class="bg-blue-50/50 rounded-xl border-2 border-dashed border-blue-200 p-6 text-center">
        <h3 class="text-[#004B87] font-bold mb-4">Add New Question</h3>
        <form asp-action="AddQuestion" method="post" class="max-w-xl mx-auto space-y-3">
            <input type="hidden" name="assignmentId" value="@Model.Id" />
            <textarea name="text" placeholder="Enter your question here..." class="w-full rounded-lg border-blue-200 text-sm focus:border-[#004B87] focus:ring-[#004B87]" rows="2" required></textarea>
            <div class="flex items-center gap-3">
                 <input type="number" name="points" value="1" min="1" class="w-20 rounded-lg border-blue-200 text-sm focus:border-[#004B87] focus:ring-[#004B87]" placeholder="Pts" required />
                 <button type="submit" class="flex-1 bg-[#004B87] text-white py-2 rounded-lg text-sm font-bold hover:bg-[#003d6e] shadow-sm">Save Question</button>
            </div>
        </form>
    </div>
</div>
